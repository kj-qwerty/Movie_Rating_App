
{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>Ratings</h2>
  <a href="{{ url_for('rating_create') }}" class="btn btn-primary">+ Add Rating</a>
</div>

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>User</th>
      <th>Movie</th>
      <th>Rating</th>
      <th>Timestamp</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for r in ratings %}
    <tr>
      <td>{{ r.userId }}</td>
      <td>{{ movie_map.get(r.movieId|string, "(deleted movie)") }}</td>
      <td>{{ "%.1f"|format(r.rating) }}</td>
      <td>{{ r.timestamp.strftime("%Y-%m-%d %H:%M") if r.timestamp else "-" }}</td>
      <td>
        <a href="{{ url_for('rating_edit', rating_id=r._id) }}" class="btn btn-sm btn-secondary">Edit</a>
        <form action="{{ url_for('rating_delete', rating_id=r._id) }}" method="post" class="d-inline" onsubmit="return confirm('Delete this rating?');">
          <button class="btn btn-sm btn-danger">Delete</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% if not ratings %}
<p>No ratings found. Try adding one.</p>
{% endif %}
{% endblock %}
